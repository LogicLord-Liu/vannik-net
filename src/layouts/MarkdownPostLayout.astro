---
import "../styles/markdown.scss";

const {
  frontmatter: { title, date, author = "‰ΩöÂêç", cover, tags = [], readingTime },
} = Astro.props;
---

<!doctype html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
  </head>
  <body>
    <article class="post-container">
      {cover && <img src={cover} alt={title} class="cover" />}

      <header class="post-header">
        <h1 class="post-title">{title}</h1>
        <div class="post-meta">
          <time>{new Date(date).toLocaleDateString()}</time>
          <span>¬∑</span>
          <span>{author}</span>
          {
            readingTime && (
              <>
                <span>¬∑</span>
                <span>{readingTime}</span>
              </>
            )
          }
        </div>
        {
          tags.length > 0 && (
            <div class="post-tags">
              {tags.map((tag) => (
                <span class="tag" key={tag}>
                  #{tag}
                </span>
              ))}
            </div>
          )
        }
      </header>

      <!-- Markdown Ê∏≤ÊüìÂå∫Âüü -->
      <section class="markdown-content">
        <slot />
      </section>
    </article>

    <script type="module">
      import mediumZoom from "medium-zoom";

      mediumZoom(".markdown-content img", {
        background: "rgba(0, 0, 0, 0.8)",
        margin: 24,
        scrollOffset: 0,
      });
    </script>
    <script>
      // Â§çÂà∂ÊåâÈíÆÈÄªËæë
      document.addEventListener("DOMContentLoaded", () => {
        const blocks = document.querySelectorAll("pre");

        blocks.forEach((block) => {
          const button = document.createElement("button");
          button.className = "copy-btn";
          button.innerText = "üìã Copy";

          button.addEventListener("click", async () => {
            const code = block.innerText;
            try {
              await navigator.clipboard.writeText(code);
              button.innerText = "‚úÖ Copied !";
              setTimeout(() => (button.innerText = "üìã Copy"), 2000);
            } catch (err) {
              button.innerText = "‚ùå Error";
            }
          });

          block.appendChild(button);
        });
      });
    </script>
  </body>
</html>
